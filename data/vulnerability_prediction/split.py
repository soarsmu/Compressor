import json
import numpy as np

data = []
with open("unlabel_train.jsonl") as f:
    for line in f:
        data.append(json.loads(line.strip()))

preds = np.load("preds_unlabel_train_gcb.npy").tolist()
# print(preds)
new_data = []
for d, p in zip(data, preds):
    d["soft_label"] = p
    new_data.append(d)

with open("soft_unlabel_train_gcb.jsonl", "w") as f:
    for d in new_data:
        f.write(json.dumps(d) + "\n")

preds = np.load("preds_unlabel_train_gcb.npy").tolist()

print(len(preds))